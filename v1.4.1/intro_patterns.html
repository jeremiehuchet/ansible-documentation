<?php
require('../wp-blog-header.php');
get_header();
?>

<div class="row">
	<div class="container">
		<?php if (function_exists('bootstrapwp_breadcrumbs')) bootstrapwp_breadcrumbs(); ?>
	</div><!--/.container -->
</div><!--/.row -->








<div class="container doc-content">
<div class="row clear-both">
    <!-- BEGIN LEFT-SIDEBAR -->
    
<div id="left-sidebar" class="span3 sidebar">
    <div class="side-nav sidebar-block left-side-nav">
      <ul><li><a href="/docs/"><strong>Documentation Home</strong></a></li></ul>
        
                <ul>
<li><a class="reference internal" href="#">Patterns</a></li>
</ul>

        
      <hr />
      <div class="qsButton pagination-centered" />
        <a href="/quickstart"><button class="btn btn-primary" type="button">Quick Start Video</button></a>
      </div>
    </div>
</div>

    <!-- END LEFT-SIDEBAR -->
     <!-- BEGIN ARTICLE CONTENT AREA -->
    <div class="span8 main-column two-columns-left">
        
  <div class="section" id="patterns">
<h1><a class="toc-backref" href="#id1">Patterns</a><a class="headerlink" href="#patterns" title="Permalink to this headline">Â¶</a></h1>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#patterns" id="id1">Patterns</a></li>
</ul>
</div>
<p>Patterns in Ansible are how we decide which hosts to manage.  This can mean what hosts to communicate with, but in terms
of <a class="reference internal" href="playbooks.html"><em>Intro to Playbooks</em></a> it actually means what hosts to apply a particular configuration or IT process to.</p>
<p>We&#8217;ll go over how to use the command line in <a class="reference internal" href="intro_adhoc.html"><em>Introduction To Ad-Hoc Commands</em></a> section, however, basically it looks like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>ansible &lt;pattern_goes_here&gt; -m &lt;module_name&gt; -a &lt;arguments&gt;
</pre></div>
</div>
<p>Such as:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>ansible webservers -m service -a &quot;name=httpd state=restarted&quot;
</pre></div>
</div>
<p>A pattern usually refers to a set of groups (which are sets of hosts) &#8211; in the above case, machines in the &#8220;webservers&#8221; group.</p>
<p>Anyway, to use Ansible, you&#8217;ll first need to know how to tell Ansible which hosts in your inventory to talk to.
This is done by designating particular host names or groups of hosts.</p>
<p>The following patterns are equivalent and target all hosts in the inventory:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>all
*
</pre></div>
</div>
<p>It is also possible to address a specific host or set of hosts by name:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>one.example.com
one.example.com:two.example.com
192.168.1.50
192.168.1.*
</pre></div>
</div>
<p>The following patterns address one or more groups.  Groups separated by a colon indicate an &#8220;OR&#8221; configuration.
This means the host may be in either one group or the other:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>webservers
webservers:dbservers
</pre></div>
</div>
<p>You can exclude groups as well, for instance, all machines must be in the group webservers but not in the group phoenix:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>webservers:!phoenix
</pre></div>
</div>
<p>You can also specify the intersection of two groups.  This would mean the hosts must be in the group webservers and
the host must also be in the group staging:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>webservers:&amp;staging
</pre></div>
</div>
<p>You can do combinations:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>webservers:dbservers:&amp;staging:!phoenix
</pre></div>
</div>
<p>The above configuration means &#8220;all machines in the groups &#8216;webservers&#8217; and &#8216;dbservers&#8217; are to be managed if they are in
the group &#8216;staging&#8217; also, but the machines are not to be managed if they are in the group &#8216;phoenix&#8217; ... whew!</p>
<p>You can also use variables if you want to pass some group specifiers via the &#8220;-e&#8221; argument to ansible-playbook, but this
is uncommonly used:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>webservers:!{{excluded}}:&amp;{{required}}
</pre></div>
</div>
<p>You also don&#8217;t have to manage by strictly defined groups.  Individual host names, IPs and groups, can also be referenced using
wildcards:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>*.example.com
*.com
</pre></div>
</div>
<p>It&#8217;s also ok to mix wildcard patterns and groups at the same time:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>one*.com:dbservers
</pre></div>
</div>
<p>Most people don&#8217;t specify patterns as regular expressions, but you can.  Just start the pattern with a &#8216;~&#8217;:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>~(web|db).*\.example\.com
</pre></div>
</div>
<p>While we&#8217;re jumping a bit ahead, additionally, you can add an exclusion criteria just by supplying the &#8220;&#8211;limit&#8221; flag to /usr/bin/ansible or /usr/bin/ansible-playbook:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>ansible-playbook site.yml --limit datacenter2
</pre></div>
</div>
<p>Easy enough.  See <a class="reference internal" href="intro_adhoc.html"><em>Introduction To Ad-Hoc Commands</em></a> and then <a class="reference internal" href="playbooks.html"><em>Intro to Playbooks</em></a> for how to apply this knowledge.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="intro_adhoc.html"><em>Introduction To Ad-Hoc Commands</em></a></dt>
<dd>Examples of basic commands</dd>
<dt><a class="reference internal" href="playbooks.html"><em>Intro to Playbooks</em></a></dt>
<dd>Learning ansible&#8217;s configuration management language</dd>
<dt><a class="reference external" href="http://groups.google.com/group/ansible-project">Mailing List</a></dt>
<dd>Questions? Help? Ideas?  Stop by the list on Google Groups</dd>
<dt><a class="reference external" href="http://irc.freenode.net">irc.freenode.net</a></dt>
<dd>#ansible IRC chat channel</dd>
</dl>
</div>
</div>


    </div><!-- END ARTICLE CONTENT AREA -->
</div> <!-- class=row -->
</div> <!-- class=container -->

<?php get_footer('home'); ?>