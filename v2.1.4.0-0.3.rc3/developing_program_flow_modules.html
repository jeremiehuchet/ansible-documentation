

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Google Tag Manager Data Layer -->
  <script>
   dataLayer = [];
  </script>
  <!-- End Google Tag Manager Data Layer -->

  
  <title>Modules &mdash; Ansible v2.1.4.0-0.3.rc3 Documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>
  <link href='https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.0.3/css/font-awesome.min.css' rel='stylesheet' type='text/css'>

  
  

    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:'./',
        VERSION:'0.01',
        COLLAPSE_INDEX:false,
        FILE_SUFFIX:'.html',
        HAS_SOURCE:  false
      };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.min.css" type="text/css" />
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
    <link rel="top" title="Ansible v2.1.4.0-0.3.rc3 Documentation" href="index.html"/> 

  <script src="//cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

  <style>
    .search-reset-start {
        color: #463E3F;
        float: right;
        position: relative;
        top: -25px;
        left: -10px;
        z-index: 10;
     }
     .search-reset-start:hover {
        cursor: pointer;
        color: #2980B9;
     }
     #search-box-id {
        padding-right: 25px;
     }
  </style>

  <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,300'
    rel='stylesheet' type='text/css'>

</head>

<body class="wy-body-for-nav">

  <!-- Google Tag Manager -->
  <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-PSB293" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-PSB293');</script>
  <!-- End Google Tag Manager -->

  <a class="DocSite-nav" href="http://docs.ansible.com/">
    <img class="DocSiteNav-logo"
      src="_static/images/logo_invert.png"
      alt="Ansible Logo">
    <div class="DocSiteNav-title">
      Documentation v2.1.4.0-0.3.rc3
    </div>
  </a>

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">

      <div style="background-color:#5bbdbf;height=80px;margin:'auto auto auto auto'">
        <a class="DocSiteProduct-header DocSiteProduct-header--core"
          href="http://docs.ansible.com/ansible/">
          <div class="DocSiteProduct-productName">
            <div class="DocSiteProduct-logoText">
              ANSIBLE
            </div>
          </div>
        </a>
      </div>

      <div id="menu-id" class="wy-menu wy-menu-vertical" data-spy="affix">
        
        
            <ul>
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="intro_installation.html">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro_getting_started.html">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro_inventory.html">Inventory</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro_dynamic_inventory.html">Dynamic Inventory</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro_patterns.html">Patterns</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro_adhoc.html">Introduction To Ad-Hoc Commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro_configuration.html">Configuration file</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro_bsd.html">BSD Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro_windows.html">Windows Support</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart Video</a></li>
<li class="toctree-l1"><a class="reference internal" href="playbooks.html">Playbooks</a><ul>
<li class="toctree-l2"><a class="reference internal" href="playbooks_intro.html">Intro to Playbooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="playbooks_roles.html">Playbook Roles and Include Statements</a></li>
<li class="toctree-l2"><a class="reference internal" href="playbooks_variables.html">Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="playbooks_filters.html">Jinja2 filters</a></li>
<li class="toctree-l2"><a class="reference internal" href="playbooks_conditionals.html">Conditionals</a></li>
<li class="toctree-l2"><a class="reference internal" href="playbooks_loops.html">Loops</a></li>
<li class="toctree-l2"><a class="reference internal" href="playbooks_blocks.html">Blocks</a></li>
<li class="toctree-l2"><a class="reference internal" href="playbooks_strategies.html">Strategies</a></li>
<li class="toctree-l2"><a class="reference internal" href="playbooks_best_practices.html">Best Practices</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="playbooks_special_topics.html">Playbooks: Special Topics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="become.html">Become (Privilege Escalation)</a></li>
<li class="toctree-l2"><a class="reference internal" href="playbooks_acceleration.html">Accelerated Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="playbooks_async.html">Asynchronous Actions and Polling</a></li>
<li class="toctree-l2"><a class="reference internal" href="playbooks_checkmode.html">Check Mode (&#8220;Dry Run&#8221;)</a></li>
<li class="toctree-l2"><a class="reference internal" href="playbooks_debugger.html">Playbook Debugger</a></li>
<li class="toctree-l2"><a class="reference internal" href="playbooks_delegation.html">Delegation, Rolling Updates, and Local Actions</a></li>
<li class="toctree-l2"><a class="reference internal" href="playbooks_environment.html">Setting the Environment (and Working With Proxies)</a></li>
<li class="toctree-l2"><a class="reference internal" href="playbooks_error_handling.html">Error Handling In Playbooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="playbooks_advanced_syntax.html">Advanced Syntax</a></li>
<li class="toctree-l2"><a class="reference internal" href="playbooks_lookups.html">Using Lookups</a></li>
<li class="toctree-l2"><a class="reference internal" href="playbooks_prompts.html">Prompts</a></li>
<li class="toctree-l2"><a class="reference internal" href="playbooks_tags.html">Tags</a></li>
<li class="toctree-l2"><a class="reference internal" href="playbooks_vault.html">Vault</a></li>
<li class="toctree-l2"><a class="reference internal" href="playbooks_startnstep.html">Start and Step</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="modules.html">About Modules</a><ul>
<li class="toctree-l2"><a class="reference internal" href="modules_intro.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="modules_core.html">Core Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="modules_extra.html">Extras Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="common_return_values.html">Common Return Values</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="guides.html">Detailed Guides</a><ul>
<li class="toctree-l2"><a class="reference internal" href="guide_aws.html">Amazon Web Services Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide_azure.html">Getting Started with Azure</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide_rax.html">Rackspace Cloud Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide_gce.html">Google Cloud Platform Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide_cloudstack.html">CloudStack Cloud Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide_vagrant.html">Using Vagrant and Ansible</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide_rolling_upgrade.html">Continuous Delivery and Rolling Upgrades</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide_docker.html">Getting Started with Docker</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="developing.html">Developer Information</a><ul>
<li class="toctree-l2"><a class="reference internal" href="developing_api.html">Python API</a></li>
<li class="toctree-l2"><a class="reference internal" href="developing_inventory.html">Developing Dynamic Inventory Sources</a></li>
<li class="toctree-l2"><a class="reference internal" href="developing_modules.html">Developing Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="developing_plugins.html">Developing Plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="developing_test_pr.html">Helping Testing PRs</a></li>
<li class="toctree-l2"><a class="reference internal" href="developing_releases.html">Releases</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tower.html">Ansible Tower</a></li>
<li class="toctree-l1"><a class="reference internal" href="community.html">Community Information &amp; Contributing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="community.html#ansible-users">Ansible Users</a></li>
<li class="toctree-l2"><a class="reference internal" href="community.html#for-current-and-prospective-developers">For Current and Prospective Developers</a></li>
<li class="toctree-l2"><a class="reference internal" href="community.html#other-topics">Other Topics</a></li>
<li class="toctree-l2"><a class="reference internal" href="community.html#community-code-of-conduct">Community Code of Conduct</a></li>
<li class="toctree-l2"><a class="reference internal" href="community.html#contributors-license-agreement">Contributors License Agreement</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="galaxy.html">Ansible Galaxy</a><ul>
<li class="toctree-l2"><a class="reference internal" href="galaxy.html#the-website">The Website</a></li>
<li class="toctree-l2"><a class="reference internal" href="galaxy.html#the-ansible-galaxy-command-line-tool">The ansible-galaxy command line tool</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="test_strategies.html">Testing Strategies</a><ul>
<li class="toctree-l2"><a class="reference internal" href="test_strategies.html#integrating-testing-with-ansible-playbooks">Integrating Testing With Ansible Playbooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="test_strategies.html#the-right-level-of-testing">The Right Level of Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="test_strategies.html#check-mode-as-a-drift-test">Check Mode As A Drift Test</a></li>
<li class="toctree-l2"><a class="reference internal" href="test_strategies.html#modules-that-are-useful-for-testing">Modules That Are Useful for Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="test_strategies.html#testing-lifecycle">Testing Lifecycle</a></li>
<li class="toctree-l2"><a class="reference internal" href="test_strategies.html#integrating-testing-with-rolling-updates">Integrating Testing With Rolling Updates</a></li>
<li class="toctree-l2"><a class="reference internal" href="test_strategies.html#achieving-continuous-deployment">Achieving Continuous Deployment</a></li>
<li class="toctree-l2"><a class="reference internal" href="test_strategies.html#conclusion">Conclusion</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">Frequently Asked Questions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="faq.html#how-can-i-set-the-path-or-any-other-environment-variable-for-a-task-or-entire-playbook">How can I set the PATH or any other environment variable for a task or entire playbook?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#how-do-i-handle-different-machines-needing-different-user-accounts-or-ports-to-log-in-with">How do I handle different machines needing different user accounts or ports to log in with?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#how-do-i-get-ansible-to-reuse-connections-enable-kerberized-ssh-or-have-ansible-pay-attention-to-my-local-ssh-config-file">How do I get ansible to reuse connections, enable Kerberized SSH, or have Ansible pay attention to my local SSH config file?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#how-do-i-configure-a-jump-host-to-access-servers-that-i-have-no-direct-access-to">How do I configure a jump host to access servers that I have no direct access to?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#how-do-i-speed-up-management-inside-ec2">How do I speed up management inside EC2?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#how-do-i-handle-python-pathing-not-having-a-python-2-x-in-usr-bin-python-on-a-remote-machine">How do I handle python pathing not having a Python 2.X in /usr/bin/python on a remote machine?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#what-is-the-best-way-to-make-content-reusable-redistributable">What is the best way to make content reusable/redistributable?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#where-does-the-configuration-file-live-and-what-can-i-configure-in-it">Where does the configuration file live and what can I configure in it?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#how-do-i-disable-cowsay">How do I disable cowsay?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#how-do-i-see-a-list-of-all-of-the-ansible-variables">How do I see a list of all of the ansible_ variables?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#how-do-i-see-all-the-inventory-vars-defined-for-my-host">How do I see all the inventory vars defined for my host?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#how-do-i-loop-over-a-list-of-hosts-in-a-group-inside-of-a-template">How do I loop over a list of hosts in a group, inside of a template?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#how-do-i-access-a-variable-name-programmatically">How do I access a variable name programmatically?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#how-do-i-access-a-variable-of-the-first-host-in-a-group">How do I access a variable of the first host in a group?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#how-do-i-copy-files-recursively-onto-a-target-host">How do I copy files recursively onto a target host?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#how-do-i-access-shell-environment-variables">How do I access shell environment variables?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#how-do-i-generate-crypted-passwords-for-the-user-module">How do I generate crypted passwords for the user module?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#can-i-get-training-on-ansible-or-find-commercial-support">Can I get training on Ansible or find commercial support?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#is-there-a-web-interface-rest-api-etc">Is there a web interface / REST API / etc?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#how-do-i-submit-a-change-to-the-documentation">How do I submit a change to the documentation?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#how-do-i-keep-secret-data-in-my-playbook">How do I keep secret data in my playbook?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#when-should-i-use-also-how-to-interpolate-variables-or-dynamic-variable-names">When should I use {{ }}? Also, how to interpolate variables or dynamic variable names</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#i-don-t-see-my-question-here">I don&#8217;t see my question here</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="YAMLSyntax.html">YAML Syntax</a><ul>
<li class="toctree-l2"><a class="reference internal" href="YAMLSyntax.html#yaml-basics">YAML Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="YAMLSyntax.html#gotchas">Gotchas</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="porting_guide_2.0.html">Porting Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="porting_guide_2.0.html#playbook">Playbook</a></li>
<li class="toctree-l2"><a class="reference internal" href="porting_guide_2.0.html#deprecated">Deprecated</a></li>
<li class="toctree-l2"><a class="reference internal" href="porting_guide_2.0.html#other-caveats">Other caveats</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="porting_guide_2.0.html#porting-plugins">Porting plugins</a><ul>
<li class="toctree-l2"><a class="reference internal" href="porting_guide_2.0.html#lookup-plugins">Lookup plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="porting_guide_2.0.html#connection-plugins">Connection plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="porting_guide_2.0.html#action-plugins">Action plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="porting_guide_2.0.html#callback-plugins">Callback plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="porting_guide_2.0.html#id1">Connection plugins</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="porting_guide_2.0.html#hybrid-plugins">Hybrid plugins</a><ul>
<li class="toctree-l2"><a class="reference internal" href="porting_guide_2.0.html#id2">Lookup plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="porting_guide_2.0.html#id3">Connection plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="porting_guide_2.0.html#id4">Action plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="porting_guide_2.0.html#id5">Callback plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="porting_guide_2.0.html#id6">Connection plugins</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="porting_guide_2.0.html#porting-custom-scripts">Porting custom scripts</a></li>
</ul>

        

<!-- changeable widget -->
<center>
<br/>
<a href="http://www.ansible.com/docs-left?utm_source=docs">
    <img style="border-width:0px;" src="https://cdn2.hubspot.net/hubfs/330046/docs-graphics/ASB-docs-left-rail.png" />
</a>
</center>


      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top">
        <i data-toggle="wy-nav-top" class="icon icon-reorder"></i>
        <a href="/">Ansible Documentation</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">

          <!-- Banner ads -->
          <div class="DocSiteBanner">
            <a class="DocSiteBanner-imgWrapper"
                href="http://www.ansible.com/docs-top?utm_source=docs">
                <img src="https://cdn2.hubspot.net/hubfs/330046/docs-graphics/ASB-docs-top-left.png">
            </a>
            <a class="DocSiteBanner-imgWrapper"
                href="http://www.ansible.com/docs-top?utm_source=docs">
                <img src="https://cdn2.hubspot.net/hubfs/330046/docs-graphics/ASB-docs-top-right.png">
            </a>
        </div>

          <ul class="wy-breadcrumbs">
  <li><a href="index.html">Docs</a> &raquo;</li>
  <li><a href="">Modules</a></li>
  
    <li class="wy-breadcrumbs-aside">
      <a href="https://github.com/ansible/ansible/blob/devel/docsite/rst/developing_program_flow_modules.rst" class="icon icon-github"> Edit on GitHub</a>
    </li>
  
</ul>
<hr/>

          <div id="page-content">
          
  <div class="section" id="modules">
<span id="flow-modules"></span><h1>Modules<a class="headerlink" href="#modules" title="Permalink to this headline">¶</a></h1>
<p>This in-depth dive helps you understand Ansible&#8217;s program flow to execute
modules. It is written for people working on the portions of the Core Ansible
Engine that execute a module. Those writing Ansible Modules may also find this
in-depth dive to be of interest, but individuals simply using Ansible Modules
will not likely find this to be helpful.</p>
<div class="section" id="types-of-modules">
<span id="flow-types-of-modules"></span><h2>Types of Modules<a class="headerlink" href="#types-of-modules" title="Permalink to this headline">¶</a></h2>
<p>Ansible supports several different types of modules in its code base.  Some of
these are for backwards compatibility and others are to enable flexibility.</p>
<div class="section" id="action-plugins">
<span id="flow-action-plugins"></span><h3>Action Plugins<a class="headerlink" href="#action-plugins" title="Permalink to this headline">¶</a></h3>
<p>Action Plugins look like modules to end users who are writing <a class="reference internal" href="glossary.html#term-playbooks"><span class="xref std std-term">playbooks</span></a> but
they&#8217;re distinct entities for the purposes of this paper.  Action Plugins
always execute on the controller and are sometimes able to do all work there
(for instance, the debug Action Plugin which prints some text for the user to
see or the assert Action Plugin which can test whether several values in
a playbook satisfy certain criteria.)</p>
<p>More often, Action Plugins set up some values on the controller, then invoke an
actual module on the managed node that does something with these values.  An
easy to understand version of this is the <span class="xref std std-ref">template Action Plugin</span>.  The <span class="xref std std-ref">template Action Plugin</span> takes values from
the user to construct a file in a temporary location on the controller using
variables from the playbook environment.  It then transfers the temporary file
to a temporary file on the remote system.  After that, it invokes the
<span class="xref std std-ref">copy module</span> which operates on the remote system to move the file
into its final location, sets file permissions, and so on.</p>
</div>
<div class="section" id="new-style-modules">
<span id="flow-new-style-modules"></span><h3>New-style Modules<a class="headerlink" href="#new-style-modules" title="Permalink to this headline">¶</a></h3>
<p>All of the modules that ship with Ansible fall into this category.</p>
<p>New-style modules have the arguments to the module embedded inside of them in
some manner.  Non-new-style modules must copy a separate file over to the
managed node, which is less efficient as it requires two over-the-wire
connections instead of only one.</p>
<div class="section" id="python">
<span id="flow-python-modules"></span><h4>Python<a class="headerlink" href="#python" title="Permalink to this headline">¶</a></h4>
<p>New-style Python modules use the <a class="reference internal" href="#ziploader"><span>ziploader</span></a> framework for constructing
modules.  All official modules (shipped with Ansible) use either this or the
<a class="reference internal" href="#flow-powershell-modules"><span>powershell module framework</span></a>.</p>
<p>These modules use imports from <code class="code docutils literal"><span class="pre">ansible.module_utils</span></code> in order to pull in
boilerplate module code, such as argument parsing, formatting of return
values as <a class="reference internal" href="glossary.html#term-json"><span class="xref std std-term">JSON</span></a>, and various file operations.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In Ansible, up to version 2.0.x, the official Python modules used the
<a class="reference internal" href="#module-replacer"><span>Module Replacer</span></a> framework.  For module authors, <a class="reference internal" href="#ziploader"><span>ziploader</span></a> is
largely a superset of <a class="reference internal" href="#module-replacer"><span>Module Replacer</span></a> functionality, so you usually
do not need to know about one versus the other.</p>
</div>
</div>
<div class="section" id="powershell">
<span id="flow-powershell-modules"></span><h4>Powershell<a class="headerlink" href="#powershell" title="Permalink to this headline">¶</a></h4>
<p>New-style powershell modules use the <a class="reference internal" href="#module-replacer"><span>Module Replacer</span></a> framework for
constructing modules.  These modules get a library of powershell code embedded
in them before being sent to the managed node.</p>
</div>
<div class="section" id="jsonargs">
<span id="flow-josnargs-modules"></span><h4>JSONARGS<a class="headerlink" href="#jsonargs" title="Permalink to this headline">¶</a></h4>
<p>Scripts can arrange for an argument string to be placed within them by placing
the string <code class="docutils literal"><span class="pre">&lt;&lt;INCLUDE_ANSIBLE_MODULE_JSON_ARGS&gt;&gt;</span></code> somewhere inside of the
file.  The module typically sets a variable to that value like this:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">json_arguments = &quot;&quot;&quot;&lt;&lt;INCLUDE_ANSIBLE_MODULE_JSON_ARGS&gt;&gt;&quot;&quot;&quot;</span>
</pre></div>
</div>
<p>Which is expanded as:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span></span>json_arguments = &quot;&quot;&quot;{&quot;param1&quot;: &quot;test&#39;s quotes&quot;, &quot;param2&quot;: &quot;\&quot;To be or not to be\&quot; - Hamlet&quot;}&quot;&quot;&quot;
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Ansible outputs a <a class="reference internal" href="glossary.html#term-json"><span class="xref std std-term">JSON</span></a> string with bare quotes.  Double quotes are
used to quote string values, double quotes inside of string values are
backslash escaped, and single quotes may appear unescaped inside of
a string value.  To use JSONARGS, your scripting language must have a way
to handle this type of string.  The example uses Python&#8217;s triple quoted
strings to do this.  Other scripting languages may have a similar quote
character that won&#8217;t be confused by any quotes in the JSON or it may
allow you to define your own start-of-quote and end-of-quote characters.
If the language doesn&#8217;t give you any of these then you&#8217;ll need to write
a <a class="reference internal" href="#flow-want-json-modules"><span>non-native JSON module</span></a> or
<a class="reference internal" href="#flow-old-style-modules"><span>Old-style module</span></a> instead.</p>
</div>
<p>The module typically parses the contents of <code class="docutils literal"><span class="pre">json_arguments</span></code> using a JSON
library and then use them as native variables throughout the rest of its code.</p>
</div>
</div>
<div class="section" id="non-native-want-json-modules">
<span id="flow-want-json-modules"></span><h3>Non-native want JSON modules<a class="headerlink" href="#non-native-want-json-modules" title="Permalink to this headline">¶</a></h3>
<p>If a module has the string <code class="docutils literal"><span class="pre">WANT_JSON</span></code> in it anywhere, Ansible treats
it as a non-native module that accepts a filename as its only command line
parameter.  The filename is for a temporary file containing a <a class="reference internal" href="glossary.html#term-json"><span class="xref std std-term">JSON</span></a>
string containing the module&#8217;s parameters.  The module needs to open the file,
read and parse the parameters, operate on the data, and print its return data
as a JSON encoded dictionary to stdout before exiting.</p>
<p>These types of modules are self-contained entities.  As of Ansible 2.1, Ansible
only modifies them to change a shebang line if present.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">Examples of Non-native modules written in ruby are in the <a class="reference external" href="https://github.com/ansible/ansible-for-rubyists">Ansible
for Rubyists</a> repository.</p>
</div>
</div>
<div class="section" id="old-style-modules">
<span id="flow-old-style-modules"></span><h3>Old-style Modules<a class="headerlink" href="#old-style-modules" title="Permalink to this headline">¶</a></h3>
<p>Old-style modules are similar to
<a class="reference internal" href="#flow-want-json-modules"><span>want JSON modules</span></a>, except that the file that
they take contains <code class="docutils literal"><span class="pre">key=value</span></code> pairs for their parameters instead of
<a class="reference internal" href="glossary.html#term-json"><span class="xref std std-term">JSON</span></a>.</p>
<p>Ansible decides that a module is old-style when it doesn&#8217;t have any of the
markers that would show that it is one of the other types.</p>
</div>
</div>
<div class="section" id="how-modules-are-executed">
<span id="flow-how-modules-are-executed"></span><h2>How modules are executed<a class="headerlink" href="#how-modules-are-executed" title="Permalink to this headline">¶</a></h2>
<p>When a user uses <strong class="program">ansible</strong> or <strong class="program">ansible-playbook</strong>, they
specify a task to execute.  The task is usually the name of a module along
with several parameters to be passed to the module.  Ansible takes these
values and processes them in various ways before they are finally executed on
the remote machine.</p>
<div class="section" id="executor-task-executor">
<span id="flow-executor-task-executor"></span><h3>executor/task_executor<a class="headerlink" href="#executor-task-executor" title="Permalink to this headline">¶</a></h3>
<p>The TaskExecutor receives the module name and parameters that were parsed from
the <a class="reference internal" href="glossary.html#term-playbooks"><span class="xref std std-term">playbook</span></a> (or from the command line in the case of
<strong class="command">/usr/bin/ansible</strong>).  It uses the name to decide whether it&#8217;s looking
at a module or an <a class="reference internal" href="#flow-action-plugins"><span>Action Plugin</span></a>.  If it&#8217;s
a module, it loads the <a class="reference internal" href="#flow-normal-action-plugin"><span>Normal Action Plugin</span></a>
and passes the name, variables, and other information about the task and play
to that Action Plugin for further processing.</p>
</div>
<div class="section" id="normal-action-plugin">
<span id="flow-normal-action-plugin"></span><h3>Normal Action Plugin<a class="headerlink" href="#normal-action-plugin" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal"><span class="pre">normal</span></code> Action Plugin executes the module on the remote host.  It is
the primary coordinator of much of the work to actually execute the module on
the managed machine.</p>
<ul class="simple">
<li>It takes care of creating a connection to the managed machine by
instantiating a Connection class according to the inventory configuration for
that host.</li>
<li>It adds any internal Ansible variables to the module&#8217;s parameters (for
instance, the ones that pass along <code class="docutils literal"><span class="pre">no_log</span></code> to the module).</li>
<li>It takes care of creating any temporary files on the remote machine and
cleans up afterwards.</li>
<li>It does the actual work of pushing the module and module parameters to the
remote host, although the <a class="reference internal" href="#flow-executor-module-common"><span>module_common</span></a>
code described next does the work of deciding which format those will take.</li>
<li>It handles any special cases regarding modules (for instance, various
complications around Windows modules that must have the same names as Python
modules, so that internal calling of modules from other Action Plugins work.)</li>
</ul>
<p>Much of this functionality comes from the <code class="xref py py-class docutils literal"><span class="pre">BaseAction</span></code> class,
which lives in <code class="file docutils literal"><span class="pre">plugins/action/__init__.py</span></code>.  It makes use of Connection
and Shell objects to do its work.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">When <a class="reference internal" href="glossary.html#term-tasks"><span class="xref std std-term">tasks</span></a> are run with the <code class="docutils literal"><span class="pre">async:</span></code> parameter, Ansible
uses the <code class="docutils literal"><span class="pre">async</span></code> Action Plugin instead of the <code class="docutils literal"><span class="pre">normal</span></code> Action Plugin
to invoke it.  That program flow is currently not documented.  Read the
source for information on how that works.</p>
</div>
</div>
<div class="section" id="executor-module-common-py">
<span id="flow-executor-module-common"></span><h3>executor/module_common.py<a class="headerlink" href="#executor-module-common-py" title="Permalink to this headline">¶</a></h3>
<p>Code in <code class="file docutils literal"><span class="pre">executor/module_common.py</span></code> takes care of assembling the module
to be shipped to the managed node.  The module is first read in, then examined
to determine its type.  <a class="reference internal" href="#flow-powershell-modules"><span>PowerShell</span></a> and
<span class="xref std std-ref">JSON-args modules</span> are passed through
<a class="reference internal" href="#module-replacer"><span>Module Replacer</span></a>.  New-style
<a class="reference internal" href="#flow-python-modules"><span>Python modules</span></a> are assembled by <a class="reference internal" href="#ziploader"><span>ziploader</span></a>.
<a class="reference internal" href="#flow-want-json-modules"><span>Non-native-want-JSON</span></a> and
<a class="reference internal" href="#flow-old-style-modules"><span>Old-Style modules</span></a> aren&#8217;t touched by either of
these and pass through unchanged.  After the assembling step, one final
modification is made to all modules that have a shebang line.  Ansible checks
whether the interpreter in the shebang line has a specific path configured via
an <code class="docutils literal"><span class="pre">ansible_$X_interpreter</span></code> inventory variable.  If it does, Ansible
substitutes that path for the interpreter path given in the module.  After
this Ansible returns the complete module data and the module type to the
<span class="xref std std-ref">Normal Action</span> which continues execution of
the module.</p>
<p>Next we&#8217;ll go into some details of the two assembler frameworks.</p>
<div class="section" id="module-replacer">
<span id="id1"></span><h4>Module Replacer<a class="headerlink" href="#module-replacer" title="Permalink to this headline">¶</a></h4>
<p>The Module Replacer is essentially a preprocessor (like the C Preprocessor for
those familiar with that language).  It does straight substitutions of
specific substring patterns in the module file.  There are two types of
substitutions:</p>
<ul class="simple">
<li>Replacements that only happen in the module file.  These are public
replacement strings that modules can utilize to get helpful boilerplate or
access to arguments.<ul>
<li><code class="code docutils literal"><span class="pre">from</span> <span class="pre">ansible.module_utils.MOD_LIB_NAME</span> <span class="pre">import</span> <span class="pre">*</span></code> is replaced with the
contents of the <code class="file docutils literal"><span class="pre">ansible/module_utils/MOD_LIB_NAME.py</span></code>  These should
only be used with <a class="reference internal" href="#flow-python-modules"><span>new-style Python modules</span></a>.</li>
<li><code class="code docutils literal"><span class="pre">#&lt;&lt;INCLUDE_ANSIBLE_MODULE_COMMON&gt;&gt;</span></code> is equivalent to
<code class="code docutils literal"><span class="pre">from</span> <span class="pre">ansible.module_utils.basic</span> <span class="pre">import</span> <span class="pre">*</span></code> and should also only apply
to new-style Python modules.</li>
<li><code class="code docutils literal"><span class="pre">#</span> <span class="pre">POWERSHELL_COMMON</span></code> substitutes the contents of
<code class="file docutils literal"><span class="pre">ansible/module_utils/powershell.ps1</span></code>.  It should only be used with
<a class="reference internal" href="#flow-powershell-modules"><span>new-style Powershell modules</span></a>.</li>
</ul>
</li>
<li>Replacements that are used by <code class="docutils literal"><span class="pre">ansible.module_utils</span></code> code.  These are internal
replacement patterns.  They may be used internally, in the above public
replacements, but shouldn&#8217;t be used directly by modules.<ul>
<li><code class="code docutils literal"><span class="pre">&quot;&lt;&lt;ANSIBLE_VERSION&gt;&gt;&quot;</span></code> is substituted with the Ansible version.  In
a new-style Python module, it&#8217;s better to use <code class="docutils literal"><span class="pre">from</span> <span class="pre">ansible</span> <span class="pre">import</span>
<span class="pre">__version__</span></code> and then use <code class="docutils literal"><span class="pre">__version__</span></code> instead.</li>
<li><code class="code docutils literal"><span class="pre">&quot;&lt;&lt;INCLUDE_ANSIBLE_MODULE_COMPLEX_ARGS&gt;&gt;&quot;</span></code> is substituted with
a string which is the Python <code class="docutils literal"><span class="pre">repr</span></code> of the <a class="reference internal" href="glossary.html#term-json"><span class="xref std std-term">JSON</span></a> encoded module
parameters.  Using <code class="docutils literal"><span class="pre">repr</span></code> on the JSON string makes it safe to embed in
a Python file.  In <a class="reference internal" href="#flow-python-modules"><span>new-style Python modules</span></a>
under <a class="reference internal" href="#ziploader"><span>ziploader</span></a> this is passed in via an environment variable
instead.</li>
<li><code class="code docutils literal"><span class="pre">&lt;&lt;SELINUX_SPECIAL_FILESYSTEMS&gt;&gt;</span></code> substitutes a string which is
a comma separated list of file systems which have a file system dependent
security context in SELinux.  In new-style Python modules, this is found
by looking up <code class="docutils literal"><span class="pre">SELINUX_SPECIAL_FS</span></code> from the
<span class="target" id="index-0"></span><code class="xref std std-envvar docutils literal"><span class="pre">ANSIBLE_MODULE_CONSTANTS</span></code> environment variable.  See the
<a class="reference internal" href="#ziploader"><span>ziploader</span></a> documentation for details.</li>
<li><code class="code docutils literal"><span class="pre">&lt;&lt;INCLUDE_ANSIBLE_MODULE_JSON_ARGS&gt;&gt;</span></code> substitutes the module
parameters as a JSON string.  Care must be taken to properly quote the
string as JSON data may contain quotes.  This pattern is not substituted
in new-style Python modules as they can get the module parameters via the
environment variable.</li>
<li>the string <code class="code docutils literal"><span class="pre">syslog.LOG_USER</span></code> is replaced wherever it occurs with the
value of <code class="docutils literal"><span class="pre">syslog_facility</span></code> from the <code class="file docutils literal"><span class="pre">ansible.cfg</span></code> or any
<code class="docutils literal"><span class="pre">ansible_syslog_facility</span></code> inventory variable that applies to this host.  In
new-style Python modules, you can get the value of the <code class="docutils literal"><span class="pre">syslog_facility</span></code>
by looking up <code class="docutils literal"><span class="pre">SYSLOG_FACILITY</span></code> in the <span class="target" id="index-1"></span><code class="xref std std-envvar docutils literal"><span class="pre">ANSIBLE_MODULE_CONSTANTS</span></code>
environment variable.  See the <a class="reference internal" href="#ziploader"><span>ziploader</span></a> documentation for details.</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="ziploader">
<span id="id2"></span><h4>ziploader<a class="headerlink" href="#ziploader" title="Permalink to this headline">¶</a></h4>
<p>Ziploader differs from <a class="reference internal" href="#module-replacer"><span>Module Replacer</span></a> in that it uses real Python
imports of things in module_utils instead of merely preprocessing the module.
It does this by constructing a zipfile&#8211;which includes the module file, files
in <code class="file docutils literal"><span class="pre">ansible/module_utils</span></code> that are imported by the module, and some
boilerplate to pass in the constants.  The zipfile is then Base64 encoded and
wrapped in a small Python script which decodes the Base64 encoding and places
the zipfile into a temp direcrtory on the managed node.  It then extracts just
the ansible module script from the zip file and places that in the temporary
directory as well.  Then it sets the PYTHONPATH to find python modules inside
of the zip file and invokes <strong class="command">python</strong> on the extracted ansible module.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Ansible wraps the zipfile in the Python script for two reasons:</p>
<ul class="last simple">
<li>for compatibility with Python-2.4 and Python-2.6 which have less
featureful versions of Python&#8217;s <code class="docutils literal"><span class="pre">-m</span></code> command line switch.</li>
<li>so that pipelining will function properly.  Pipelining needs to pipe the
Python module into the Python interpreter on the remote node.  Python
understands scripts on stdin but does not understand zip files.</li>
</ul>
</div>
<p>In ziploader, any imports of Python modules from the <code class="docutils literal"><span class="pre">ansible.module_utils</span></code>
package trigger inclusion of that Python file into the zipfile.  Instances of
<code class="code docutils literal"><span class="pre">#&lt;&lt;INCLUDE_ANSIBLE_MODULE_COMMON&gt;&gt;</span></code> in the module are turned into
<code class="code docutils literal"><span class="pre">from</span> <span class="pre">ansible.module_utils.basic</span> <span class="pre">import</span> <span class="pre">*</span></code> and
<code class="file docutils literal"><span class="pre">ansible/module-utils/basic.py</span></code> is then included in the zipfile.  Files
that are included from module_utils are themselves scanned for imports of other
Python modules from module_utils to be included in the zipfile as well.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">At present, Ziploader cannot determine whether an import should be
included if it is a relative import.  Always use an absolute import that
has <code class="docutils literal"><span class="pre">ansible.module_utils</span></code> in it to allow ziploader to determine that
the file should be included.</p>
</div>
<div class="section" id="passing-args">
<span id="flow-passing-module-args"></span><h5>Passing args<a class="headerlink" href="#passing-args" title="Permalink to this headline">¶</a></h5>
<p>In <a class="reference internal" href="#module-replacer"><span>Module Replacer</span></a>, module arguments are turned into a JSON-ified
string and substituted into the combined module file.  In <a class="reference internal" href="#ziploader"><span>ziploader</span></a>,
the JSON-ified string is passed into the module via stdin.  When
a  <code class="xref py py-class docutils literal"><span class="pre">ansible.module_utils.basic.AnsibleModule</span></code> is instantiated,
it parses this string and places the args into
<a href="#id3"><span class="problematic" id="id4">:attribute:`AnsibleModule.params`</span></a> where it can be accessed by the module&#8217;s
other code.</p>
</div>
<div class="section" id="passing-constants">
<span id="flow-passing-module-constants"></span><h5>Passing constants<a class="headerlink" href="#passing-constants" title="Permalink to this headline">¶</a></h5>
<p>Currently, there are three constants passed from the controller to the modules:
<code class="docutils literal"><span class="pre">ANSIBLE_VERSION</span></code>, <code class="docutils literal"><span class="pre">SELINUX_SPECIAL_FS</span></code>, and <code class="docutils literal"><span class="pre">SYSLOG_FACILITY</span></code>.  In
<a class="reference internal" href="#module-replacer"><span>Module Replacer</span></a>, <code class="docutils literal"><span class="pre">ANSIBLE_VERSION</span></code> and <code class="docutils literal"><span class="pre">SELINUX_SPECIAL_FS</span></code> were
substituted into the global variables
<code class="code docutils literal"><span class="pre">ansible.module_utils.basic.ANSIBLE_VERSION</span></code> and
<code class="code docutils literal"><span class="pre">ansible.module_utils.basic.SELINUX_SPECIAL_FS</span></code>.  <code class="docutils literal"><span class="pre">SYSLOG_FACILITY</span></code> didn&#8217;t
get placed into a variable.  Instead, any occurrences of the string
<code class="docutils literal"><span class="pre">syslog.LOG_USER</span></code> in the combined module file were replaced with <code class="docutils literal"><span class="pre">syslog.</span></code>
followed by the string contained in <code class="docutils literal"><span class="pre">SYSLOG_FACILITY</span></code>.  All of these have
changed in <a class="reference internal" href="#ziploader"><span>ziploader</span></a>.</p>
<p>The Ansible verison can now be used by a module by importing <code class="docutils literal"><span class="pre">__version__</span></code>
from ansible:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span></span>from ansible import __version__
module.exit_json({&#39;msg&#39;: &#39;module invoked by ansible %s&#39; % __version__})
</pre></div>
</div>
<p>For now, <code class="code docutils literal"><span class="pre">ANSIBLE_VERSION</span></code> is also available at its old location inside of
<code class="docutils literal"><span class="pre">ansible.module_utils.basic</span></code>, but that will eventually be removed.</p>
<p><code class="docutils literal"><span class="pre">SELINUX_SPECIAL_FS</span></code> and  <code class="docutils literal"><span class="pre">SYSLOG_FACILITY</span></code> have changed much more.
<a class="reference internal" href="#ziploader"><span>ziploader</span></a> passes these as part of the JSON-ified argument string via stdin.
When
<code class="xref py py-class docutils literal"><span class="pre">ansible.module_utils.basic.AnsibleModule</span></code> is instantiated, it parses this
string and places the constants into <a href="#id5"><span class="problematic" id="id6">:attribute:`AnsibleModule.constants`</span></a>
where other code can access it.</p>
<p>Unlike the <code class="docutils literal"><span class="pre">ANSIBLE_VERSION</span></code>, where some efforts were made to keep the old
backwards compatible globals available, these two constants are not available
at their old names.  This is a combination of the degree to which these are
internal to the needs of <code class="docutils literal"><span class="pre">module_utils.basic</span></code> and, in the case of
<code class="docutils literal"><span class="pre">SYSLOG_FACILITY</span></code>, how hacky and unsafe the previous implementation was.</p>
<p>Porting code from the <a class="reference internal" href="#module-replacer"><span>Module Replacer</span></a> method of getting
<code class="docutils literal"><span class="pre">SYSLOG_FACILITY</span></code> to the new one is a little more tricky than the other
constants and args, due to just how hacky the old way was.  Here&#8217;s an example
of using it in the new way:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">import syslog</span>
<span class="l l-Scalar l-Scalar-Plain">facility_name = module.constants.get(&#39;SYSLOG_FACILITY&#39;)</span>
<span class="l l-Scalar l-Scalar-Plain">facility = getattr(syslog, facility_name)</span>
<span class="l l-Scalar l-Scalar-Plain">syslog.openlog(str(module), 0, facility)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="special-considerations">
<span id="flow-special-considerations"></span><h3>Special Considerations<a class="headerlink" href="#special-considerations" title="Permalink to this headline">¶</a></h3>
<div class="section" id="pipelining">
<span id="flow-pipelining"></span><h4>Pipelining<a class="headerlink" href="#pipelining" title="Permalink to this headline">¶</a></h4>
<p>Ansible can transfer a module to a remote machine in one of two ways:</p>
<ul class="simple">
<li>it can write out the module to a temporary file on the remote host and then
use a second connection to the remote host to execute it with the
interpreter that the module needs</li>
<li>or it can use what&#8217;s known as pipelining to execute the module by piping it
into the remote interpreter&#8217;s stdin.</li>
</ul>
<p>Pipelining only works with modules written in Python at this time because
Ansible only knows that Python supports this mode of operation.  Supporting
pipelining means that whatever format the module payload takes before being
sent over the wire must be executable by Python via stdin.</p>
</div>
</div>
</div>
</div>


          </div>
          <div id="search-results"><gcse:searchresults-only></div>
          <footer>
  

  <hr/>

<script type="text/javascript">
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
  (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
  e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

  _st('install','yABGvz2N8PwcwBxyfzUc','2.0.0');
</script>

  <p>
  &copy; Copyright 2016 <a href="http://ansible.com">Ansible, Inc.</a>.
    Last updated on Jan 20, 2017.
  </p>

Ansible docs are generated from <a href="https://github.com/ansible/ansible">GitHub sources</A> using <A HREF="http://sphinx-doc.org/">Sphinx</A> using a theme provided by <a href="http://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  


<!-- begin analytics -->
<script type="text/javascript">
var _hsq = _hsq || [];
_hsq.push(["setContentType", "standard-page"]);
        (function(d,s,i,r) {
        if (d.getElementById(i)){return;}
        var n = d.createElement(s),e = document.getElementsByTagName(s)[0];
        n.id=i;n.src = '//js.hs-analytics.net/analytics/'+(Math.ceil(new Date()/r)*r)+'/330046.js';
        e.parentNode.insertBefore(n, e);
        })(document, "script", "hs-analytics",300000);
</script>
<!-- end analytics -->

</body>
</html>