<?php
require('../wp-blog-header.php');
get_header();
?>

<div class="row">
	<div class="container">
		<?php if (function_exists('bootstrapwp_breadcrumbs')) bootstrapwp_breadcrumbs(); ?>
	</div><!--/.container -->
</div><!--/.row -->








<div class="container doc-content">
<div class="row clear-both">
    <!-- BEGIN LEFT-SIDEBAR -->
    
<div id="left-sidebar" class="span3 sidebar">
    <div class="side-nav sidebar-block left-side-nav">
      <ul><li><a href="/docs/"><strong>Documentation Home</strong></a></li></ul>
        
                <ul>
<li><a class="reference internal" href="#">Error Handling In Playbooks</a><ul>
<li><a class="reference internal" href="#ignoring-failed-commands">Ignoring Failed Commands</a></li>
<li><a class="reference internal" href="#controlling-what-defines-failure">Controlling What Defines Failure</a></li>
<li><a class="reference internal" href="#overriding-the-changed-result">Overriding The Changed Result</a></li>
</ul>
</li>
</ul>

        
      <hr />
      <div class="qsButton pagination-centered" />
        <a href="/quickstart"><button class="btn btn-primary" type="button">Quick Start Video</button></a>
      </div>
    </div>
</div>

    <!-- END LEFT-SIDEBAR -->
     <!-- BEGIN ARTICLE CONTENT AREA -->
    <div class="span8 main-column two-columns-left">
        
  <div class="section" id="error-handling-in-playbooks">
<h1><a class="toc-backref" href="#id3">Error Handling In Playbooks</a><a class="headerlink" href="#error-handling-in-playbooks" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#error-handling-in-playbooks" id="id3">Error Handling In Playbooks</a><ul>
<li><a class="reference internal" href="#ignoring-failed-commands" id="id4">Ignoring Failed Commands</a></li>
<li><a class="reference internal" href="#controlling-what-defines-failure" id="id5">Controlling What Defines Failure</a></li>
<li><a class="reference internal" href="#overriding-the-changed-result" id="id6">Overriding The Changed Result</a></li>
</ul>
</li>
</ul>
</div>
<p>Ansible normally has defaults that make sure to check the return codes of commands and modules and
it fails fast &#8211; forcing an error to be dealt with unless you decide otherwise.</p>
<p>Sometimes a command that returns 0 isn&#8217;t an error.  Sometimes a command might not always
need to report that it &#8216;changed&#8217; the remote system.  This section describes how to change
the default behavior of Ansible for certain tasks so output and error handling behavior is
as desired.</p>
<div class="section" id="ignoring-failed-commands">
<span id="id1"></span><h2><a class="toc-backref" href="#id4">Ignoring Failed Commands</a><a class="headerlink" href="#ignoring-failed-commands" title="Permalink to this headline">¶</a></h2>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.6.</span></p>
</div>
<p>Generally playbooks will stop executing any more steps on a host that
has a failure.  Sometimes, though, you want to continue on.  To do so,
write a task that looks like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>- name: this will not be counted as a failure
  command: /bin/false
  ignore_errors: yes
</pre></div>
</div>
</div>
<div class="section" id="controlling-what-defines-failure">
<span id="id2"></span><h2><a class="toc-backref" href="#id5">Controlling What Defines Failure</a><a class="headerlink" href="#controlling-what-defines-failure" title="Permalink to this headline">¶</a></h2>
<div class="versionadded">
<p><span class="versionmodified">New in version 1.4.</span></p>
</div>
<p>Suppose the error code of a command is meaningless and to tell if there
is a failure what really matters is the output of the command, for instance
if the string &#8220;FAILED&#8221; is in the output.</p>
<p>Ansible in 1.4 and later provides a way to specify this behavior as follows:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>- name: this command prints FAILED when it fails
  command: /usr/bin/example-command -x -y -z
  register: command_result
  failed_when: &quot;&#39;FAILED&#39; in command_result.stderr&quot;
</pre></div>
</div>
<p>In previous version of Ansible, this can be still be accomplished as follows:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>- name: this command prints FAILED when it fails
  command: /usr/bin/example-command -x -y -z
  register: command_result
  ignore_errors: True

- name: fail the play if the previous command did not succeed
  fail: msg=&quot;the command failed&quot;
  when: &quot;&#39;FAILED&#39; in command_result.stderr&quot;
</pre></div>
</div>
</div>
<div class="section" id="overriding-the-changed-result">
<span id="override-the-changed-result"></span><h2><a class="toc-backref" href="#id6">Overriding The Changed Result</a><a class="headerlink" href="#overriding-the-changed-result" title="Permalink to this headline">¶</a></h2>
<div class="versionadded">
<p><span class="versionmodified">New in version 1.3.</span></p>
</div>
<p>When a shell/command or other module runs it will typically report
&#8220;changed&#8221; status based on whether it thinks it affected machine state.</p>
<p>Sometimes you will know, based on the return code
or output that it did not make any changes, and wish to override
the &#8220;changed&#8221; result such that it does not appear in report output or
does not cause handlers to fire:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>tasks:

  - shell: /usr/bin/billybass --mode=&quot;take me to the river&quot;
    register: bass_result
    changed_when: &quot;bass_result.rc != 2&quot;

  # this will never report &#39;changed&#39; status
  - shell: wall &#39;beep&#39;
    changed_when: False
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="playbooks.html"><em>Intro to Playbooks</em></a></dt>
<dd>An introduction to playbooks</dd>
<dt><a class="reference internal" href="playbooks_best_practices.html"><em>Best Practices</em></a></dt>
<dd>Best practices in playbooks</dd>
<dt><a class="reference internal" href="playbooks_conditionals.html"><em>Conditionals</em></a></dt>
<dd>Conditional statements in playbooks</dd>
<dt><a class="reference internal" href="playbooks_variables.html"><em>Variables</em></a></dt>
<dd>All about variables</dd>
<dt><a class="reference external" href="http://groups.google.com/group/ansible-devel">User Mailing List</a></dt>
<dd>Have a question?  Stop by the google group!</dd>
<dt><a class="reference external" href="http://irc.freenode.net">irc.freenode.net</a></dt>
<dd>#ansible IRC chat channel</dd>
</dl>
</div>
</div>
</div>


    </div><!-- END ARTICLE CONTENT AREA -->
</div> <!-- class=row -->
</div> <!-- class=container -->

<?php get_footer('home'); ?>