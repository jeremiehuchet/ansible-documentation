

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Google Tag Manager Data Layer -->
  <script>
   dataLayer = [];
  </script>
  <!-- End Google Tag Manager Data Layer -->

  
  <title>Amazon Web Services Guide &mdash; Ansible v1.9.0-1 Documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>
  <link href='https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.0.3/css/font-awesome.min.css' rel='stylesheet' type='text/css'>

  
  

    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:'./',
        VERSION:'0.01',
        COLLAPSE_INDEX:false,
        FILE_SUFFIX:'.html',
        HAS_SOURCE:  false
      };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.min.css" type="text/css" />
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
    <link rel="top" title="Ansible v1.9.0-1 Documentation" href="index.html"/>
        <link rel="up" title="Detailed Guides" href="guides.html"/>
        <link rel="next" title="Rackspace Cloud Guide" href="guide_rax.html"/>
        <link rel="prev" title="Detailed Guides" href="guides.html"/> 

  <script src="//cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

  <style>
    .search-reset-start {
        color: #463E3F;
        float: right;
        position: relative;
        top: -25px;
        left: -10px;
        z-index: 10;
     }
     .search-reset-start:hover {
        cursor: pointer;
        color: #2980B9;
     }
     #search-box-id {
        padding-right: 25px;
     }
  </style>

</head>

<body class="wy-body-for-nav">

  <!-- Google Tag Manager -->
  <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-PSB293" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-PSB293');</script>
  <!-- End Google Tag Manager -->

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div style='background-color:#64C5C7'>
        <br/>
        <center><a href="index.html"><img src="http://cdn2.hubspot.net/hub/330046/file-445792629-png/ANSI_logotype_web_white.png" style="border-radius:0;background-color:#64C5C7;width:214px;height:26px;margin:'auto auto auto auto'"></a></center>
        <br/>      
      </div>
      <div class="wy-side-nav-search" style="background-color:#64C5C7;height=80px;margin:'auto auto auto auto'">
        <!-- <a href="index.html" class="icon icon-home"> Ansible Documentation</a> -->
        <!-- <form class="wy-form" action="search.html" method="get">
  <input type="text" name="q" placeholder="Search docs" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form> -->

<script>
  (function() {
    var cx = '006019874985968165468:eu5pbnxp4po';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>

<form id="search-form-id" action="">
  <input type="text" name="query" id="search-box-id" />
  <a class="search-reset-start" id="search-reset"><i class="fa fa-times"></i></a>
  <a class="search-reset-start" id="search-start"><i class="fa fa-search"></i></a>
</form>

<script type="text/javascript" src="http://www.google.com/cse/brand?form=search-form-id&inputbox=search-box-id"></script>

<script>
  function executeQuery() {
      var input = document.getElementById('search-box-id');
      var element = google.search.cse.element.getElement('searchresults-only0');
      element.resultsUrl = '/htmlout/search.html'
      if (input.value == '') {
          element.clearAllResults();
          $('#page-content, .rst-footer-buttons, #search-start').show();
          $('#search-results, #search-reset').hide();
      } else {
          $('#page-content, .rst-footer-buttons, #search-start').hide();
          $('#search-results, #search-reset').show();
          element.execute(input.value);
      }
      return false;
      }

  $('#search-reset').hide();

  $('#search-box-id').css('background-position', '1em center');

  $('#search-box-id').on('blur', function() {
    $('#search-box-id').css('background-position', '1em center');
  });

  $('#search-start').click(function(e) { executeQuery(); });
  $('#search-reset').click(function(e) { $('#search-box-id').val(''); executeQuery(); });

  $('#search-form-id').submit(function(e) {
      console.log('submitting!');
      executeQuery();
      e.preventDefault();
      });
</script>
      </div>

      <div id="menu-id" class="wy-menu wy-menu-vertical" data-spy="affix">
        
        
            <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="intro_installation.html">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro_getting_started.html">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro_inventory.html">Inventory</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro_dynamic_inventory.html">Dynamic Inventory</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro_patterns.html">Patterns</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro_adhoc.html">Introduction To Ad-Hoc Commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro_configuration.html">The Ansible Configuration File</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro_windows.html">Windows Support</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart Video</a></li>
<li class="toctree-l1"><a class="reference internal" href="playbooks.html">Playbooks</a><ul>
<li class="toctree-l2"><a class="reference internal" href="playbooks_intro.html">Intro to Playbooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="playbooks_roles.html">Playbook Roles and Include Statements</a></li>
<li class="toctree-l2"><a class="reference internal" href="playbooks_variables.html">Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="playbooks_filters.html">Jinja2 filters</a></li>
<li class="toctree-l2"><a class="reference internal" href="playbooks_conditionals.html">Conditionals</a></li>
<li class="toctree-l2"><a class="reference internal" href="playbooks_loops.html">Loops</a></li>
<li class="toctree-l2"><a class="reference internal" href="playbooks_best_practices.html">Best Practices</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="playbooks_special_topics.html">Playbooks: Special Topics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="playbooks_acceleration.html">Accelerated Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="playbooks_async.html">Asynchronous Actions and Polling</a></li>
<li class="toctree-l2"><a class="reference internal" href="playbooks_checkmode.html">Check Mode (&#8220;Dry Run&#8221;)</a></li>
<li class="toctree-l2"><a class="reference internal" href="playbooks_delegation.html">Delegation, Rolling Updates, and Local Actions</a></li>
<li class="toctree-l2"><a class="reference internal" href="playbooks_environment.html">Setting the Environment (and Working With Proxies)</a></li>
<li class="toctree-l2"><a class="reference internal" href="playbooks_error_handling.html">Error Handling In Playbooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="playbooks_lookups.html">Using Lookups</a></li>
<li class="toctree-l2"><a class="reference internal" href="playbooks_prompts.html">Prompts</a></li>
<li class="toctree-l2"><a class="reference internal" href="playbooks_tags.html">Tags</a></li>
<li class="toctree-l2"><a class="reference internal" href="playbooks_vault.html">Vault</a></li>
<li class="toctree-l2"><a class="reference internal" href="playbooks_startnstep.html">Start and Step</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="modules.html">About Modules</a><ul>
<li class="toctree-l2"><a class="reference internal" href="modules.html#introduction">Introduction</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="guides.html">Detailed Guides</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="">Amazon Web Services Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide_rax.html">Rackspace Cloud Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide_gce.html">Google Cloud Platform Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide_vagrant.html">Using Vagrant and Ansible</a></li>
<li class="toctree-l2"><a class="reference internal" href="guide_rolling_upgrade.html">Continuous Delivery and Rolling Upgrades</a></li>
<li class="toctree-l2"><a class="reference internal" href="test_strategies.html">Testing Strategies</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="developing.html">Developer Information</a><ul>
<li class="toctree-l2"><a class="reference internal" href="developing_api.html">Python API</a></li>
<li class="toctree-l2"><a class="reference internal" href="developing_inventory.html">Developing Dynamic Inventory Sources</a></li>
<li class="toctree-l2"><a class="reference internal" href="developing_modules.html">Developing Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="developing_plugins.html">Developing Plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="developing_test_pr.html">Helping Testing PRs</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tower.html">Ansible Tower</a></li>
<li class="toctree-l1"><a class="reference internal" href="community.html">Community Information &amp; Contributing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="community.html#ansible-users">Ansible Users</a></li>
<li class="toctree-l2"><a class="reference internal" href="community.html#for-current-and-prospective-developers">For Current and Prospective Developers</a></li>
<li class="toctree-l2"><a class="reference internal" href="community.html#other-topics">Other Topics</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="galaxy.html">Ansible Galaxy</a><ul>
<li class="toctree-l2"><a class="reference internal" href="galaxy.html#the-website">The Website</a></li>
<li class="toctree-l2"><a class="reference internal" href="galaxy.html#the-ansible-galaxy-command-line-tool">The ansible-galaxy command line tool</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="test_strategies.html">Testing Strategies</a><ul>
<li class="toctree-l2"><a class="reference internal" href="test_strategies.html#integrating-testing-with-ansible-playbooks">Integrating Testing With Ansible Playbooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="test_strategies.html#the-right-level-of-testing">The Right Level of Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="test_strategies.html#check-mode-as-a-drift-test">Check Mode As A Drift Test</a></li>
<li class="toctree-l2"><a class="reference internal" href="test_strategies.html#modules-that-are-useful-for-testing">Modules That Are Useful for Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="test_strategies.html#testing-lifecycle">Testing Lifecycle</a></li>
<li class="toctree-l2"><a class="reference internal" href="test_strategies.html#integrating-testing-with-rolling-updates">Integrating Testing With Rolling Updates</a></li>
<li class="toctree-l2"><a class="reference internal" href="test_strategies.html#achieving-continuous-deployment">Achieving Continuous Deployment</a></li>
<li class="toctree-l2"><a class="reference internal" href="test_strategies.html#conclusion">Conclusion</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">Frequently Asked Questions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="faq.html#how-do-i-handle-different-machines-needing-different-user-accounts-or-ports-to-log-in-with">How do I handle different machines needing different user accounts or ports to log in with?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#how-do-i-get-ansible-to-reuse-connections-enable-kerberized-ssh-or-have-ansible-pay-attention-to-my-local-ssh-config-file">How do I get ansible to reuse connections, enable Kerberized SSH, or have Ansible pay attention to my local SSH config file?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#how-do-i-speed-up-management-inside-ec2">How do I speed up management inside EC2?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#how-do-i-handle-python-pathing-not-having-a-python-2-x-in-usr-bin-python-on-a-remote-machine">How do I handle python pathing not having a Python 2.X in /usr/bin/python on a remote machine?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#what-is-the-best-way-to-make-content-reusable-redistributable">What is the best way to make content reusable/redistributable?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#where-does-the-configuration-file-live-and-what-can-i-configure-in-it">Where does the configuration file live and what can I configure in it?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#how-do-i-disable-cowsay">How do I disable cowsay?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#how-do-i-see-a-list-of-all-of-the-ansible-variables">How do I see a list of all of the ansible_ variables?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#how-do-i-loop-over-a-list-of-hosts-in-a-group-inside-of-a-template">How do I loop over a list of hosts in a group, inside of a template?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#how-do-i-access-a-variable-name-programmatically">How do I access a variable name programmatically?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#how-do-i-access-a-variable-of-the-first-host-in-a-group">How do I access a variable of the first host in a group?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#how-do-i-copy-files-recursively-onto-a-target-host">How do I copy files recursively onto a target host?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#how-do-i-access-shell-environment-variables">How do I access shell environment variables?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#how-do-i-generate-crypted-passwords-for-the-user-module">How do I generate crypted passwords for the user module?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#can-i-get-training-on-ansible-or-find-commercial-support">Can I get training on Ansible or find commercial support?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#is-there-a-web-interface-rest-api-etc">Is there a web interface / REST API / etc?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#how-do-i-submit-a-change-to-the-documentation">How do I submit a change to the documentation?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#how-do-i-keep-secret-data-in-my-playbook">How do I keep secret data in my playbook?</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#i-don-t-see-my-question-here">I don&#8217;t see my question here</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a><ul>
<li class="toctree-l2"><a class="reference internal" href="glossary.html#action">Action</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary.html#ad-hoc">Ad Hoc</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary.html#async">Async</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary.html#callback-plugin">Callback Plugin</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary.html#check-mode">Check Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary.html#connection-type-connection-plugin">Connection Type, Connection Plugin</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary.html#conditionals">Conditionals</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary.html#diff-mode">Diff Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary.html#facts">Facts</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary.html#filter-plugin">Filter Plugin</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary.html#forks">Forks</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary.html#gather-facts-boolean">Gather Facts (Boolean)</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary.html#globbing">Globbing</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary.html#group">Group</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary.html#group-vars">Group Vars</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary.html#handlers">Handlers</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary.html#host">Host</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary.html#host-specifier">Host Specifier</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary.html#host-vars">Host Vars</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary.html#lazy-evaluation">Lazy Evaluation</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary.html#lookup-plugin">Lookup Plugin</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary.html#multi-tier">Multi-Tier</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary.html#idempotency">Idempotency</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary.html#includes">Includes</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary.html#inventory">Inventory</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary.html#inventory-script">Inventory Script</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary.html#jinja2">Jinja2</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary.html#json">JSON</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary.html#library">Library</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary.html#limit-groups">Limit Groups</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary.html#local-connection">Local Connection</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary.html#local-action">Local Action</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary.html#loops">Loops</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary.html#modules">Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary.html#notify">Notify</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary.html#orchestration">Orchestration</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary.html#paramiko">paramiko</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary.html#playbooks">Playbooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary.html#plays">Plays</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary.html#pull-mode">Pull Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary.html#push-mode">Push Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary.html#register-variable">Register Variable</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary.html#resource-model">Resource Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary.html#roles">Roles</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary.html#rolling-update">Rolling Update</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary.html#runner">Runner</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary.html#serial">Serial</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary.html#sudo">Sudo</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary.html#ssh-native">SSH (Native)</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary.html#tags">Tags</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary.html#tasks">Tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary.html#templates">Templates</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary.html#transport">Transport</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary.html#when">When</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary.html#van-halen">Van Halen</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary.html#vars-variables">Vars (Variables)</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary.html#yaml">YAML</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="YAMLSyntax.html">YAML Syntax</a><ul>
<li class="toctree-l2"><a class="reference internal" href="YAMLSyntax.html#yaml-basics">YAML Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="YAMLSyntax.html#gotchas">Gotchas</a></li>
</ul>
</li>
</ul>

        

<!-- changeable widget -->
<center>
<br/>
<span class="hs-cta-wrapper" id="hs-cta-wrapper-71d47584-8ef5-4b06-87ae-8d25bc2a837e">
    <span class="hs-cta-node hs-cta-71d47584-8ef5-4b06-87ae-8d25bc2a837e" id="hs-cta-71d47584-8ef5-4b06-87ae-8d25bc2a837e">
        <!--[if lte IE 8]><div id="hs-cta-ie-element"></div><![endif]-->
        <a href="http://cta-redirect.hubspot.com/cta/redirect/330046/71d47584-8ef5-4b06-87ae-8d25bc2a837e"><img class="hs-cta-img" id="hs-cta-img-71d47584-8ef5-4b06-87ae-8d25bc2a837e" style="border-width:0px;" src="https://no-cache.hubspot.com/cta/default/330046/71d47584-8ef5-4b06-87ae-8d25bc2a837e.png" /></a>
    </span>
    <script charset="utf-8" src="https://js.hscta.net/cta/current.js"></script>
        <script type="text/javascript">
            hbspt.cta.load(330046, '71d47584-8ef5-4b06-87ae-8d25bc2a837e');
        </script>
</span>
</center>


      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top">
        <i data-toggle="wy-nav-top" class="icon icon-reorder"></i>
        <a href="/">Ansible Documentation</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">

<!-- AnsibleFest and free eBook preview stuff -->
<center>
<a href="http://www.ansible.com/tower?utm_source=docs">
<img src="http://www.ansible.com/hs-fs/hub/330046/file-2031636235-png/DL_Folder/festlondon-docs.png">
</a>
<a href="http://www.ansible.com/ansible-book">
<img src="http://www.ansible.com/hs-fs/hub/330046/file-2031636250-png/DL_Folder/Ebook-docs.png">
</a>
<br/>&nbsp;<br/>
<br/>&nbsp;<br/>
</center>

          <ul class="wy-breadcrumbs">
  <li><a href="index.html">Docs</a> &raquo;</li>
  <li><a href="">Amazon Web Services Guide</a></li>
  
    <li class="wy-breadcrumbs-aside">
      <a href="https://github.com/ansible/ansible/blob/devel/docsite/rst/guide_aws.rst" class="icon icon-github"> Edit on GitHub</a>
    </li>
  
</ul>
<hr/>

          <div id="page-content">
          
  <div class="section" id="amazon-web-services-guide">
<h1>Amazon Web Services Guide<a class="headerlink" href="#amazon-web-services-guide" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<span id="aws-intro"></span><h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>Ansible contains a number of modules for controlling Amazon Web Services (AWS).  The purpose of this
section is to explain how to put Ansible modules together (and use inventory scripts) to use Ansible in AWS context.</p>
<p>Requirements for the AWS modules are minimal.</p>
<p>All of the modules require and are tested against recent versions of boto.  You&#8217;ll need this Python module installed on your control machine.  Boto can be installed from your OS distribution or python&#8217;s &#8220;pip install boto&#8221;.</p>
<p>Whereas classically ansible will execute tasks in it&#8217;s host loop against multiple remote machines, most cloud-control steps occur on your local machine with reference to the regions to control.</p>
<p>In your playbook steps we&#8217;ll typically be using the following pattern for provisioning steps:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>- hosts: localhost
  connection: local
  gather_facts: False
  tasks:
    - ...
</pre></div>
</div>
</div>
<div class="section" id="authentication">
<span id="aws-authentication"></span><h2>Authentication<a class="headerlink" href="#authentication" title="Permalink to this headline">¶</a></h2>
<p>Authentication with the AWS-related modules is handled by either
specifying your access and secret key as ENV variables or module arguments.</p>
<p>For environment variables:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>export AWS_ACCESS_KEY_ID=&#39;AK123&#39;
export AWS_SECRET_ACCESS_KEY=&#39;abc123&#39;
</pre></div>
</div>
<p>For storing these in a vars_file, ideally encrypted with ansible-vault:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>---
ec2_access_key: &quot;--REMOVED--&quot;
ec2_secret_key: &quot;--REMOVED--&quot;
</pre></div>
</div>
</div>
<div class="section" id="provisioning">
<span id="aws-provisioning"></span><h2>Provisioning<a class="headerlink" href="#provisioning" title="Permalink to this headline">¶</a></h2>
<p>The ec2 module provisions and de-provisions instances within EC2.</p>
<p>An example of making sure there are only 5 instances tagged &#8216;Demo&#8217; in EC2 follows.</p>
<p>In the example below, the &#8220;exact_count&#8221; of instances is set to 5.  This means if there are 0 instances already existing, then
5 new instances would be created.  If there were 2 instances, only 3 would be created, and if there were 8 instances, 3 instances would
be terminated.</p>
<p>What is being counted is specified by the &#8220;count_tag&#8221; parameter.  The parameter &#8220;instance_tags&#8221; is used to apply tags to the newly created
instance.:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span># demo_setup.yml

- hosts: localhost
  connection: local
  gather_facts: False

  tasks:

    - name: Provision a set of instances
      ec2:
         key_name: my_key
         group: test
         instance_type: t2.micro
         image: &quot;{{ ami_id }}&quot;
         wait: true
         exact_count: 5
         count_tag:
            Name: Demo
         instance_tags:
            Name: Demo
      register: ec2
</pre></div>
</div>
<p>The data about what instances are created is being saved by the &#8220;register&#8221; keyword in the variable named &#8220;ec2&#8221;.</p>
<p>From this, we&#8217;ll use the add_host module to dynamically create a host group consisting of these new instances.  This facilitates performing configuration actions on the hosts immediately in a subsequent task.:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span># demo_setup.yml

- hosts: localhost
  connection: local
  gather_facts: False

  tasks:

    - name: Provision a set of instances
      ec2:
         key_name: my_key
         group: test
         instance_type: t2.micro
         image: &quot;{{ ami_id }}&quot;
         wait: true
         exact_count: 5
         count_tag:
            Name: Demo
         instance_tags:
            Name: Demo
      register: ec2

   - name: Add all instance public IPs to host group
     add_host: hostname={{ item.public_ip }} groupname=ec2hosts
     with_items: ec2.instances
</pre></div>
</div>
<p>With the host group now created, a second play at the bottom of the the same provisioning playbook file might now have some configuration steps:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span># demo_setup.yml

- name: Provision a set of instances
  hosts: localhost
  # ... AS ABOVE ...

- hosts: ec2hosts
  name: configuration play
  user: ec2-user
  gather_facts: true

  tasks:

     - name: Check NTP service
       service: name=ntpd state=started
</pre></div>
</div>
</div>
<div class="section" id="host-inventory">
<span id="aws-host-inventory"></span><h2>Host Inventory<a class="headerlink" href="#host-inventory" title="Permalink to this headline">¶</a></h2>
<p>Once your nodes are spun up, you&#8217;ll probably want to talk to them again.  With a cloud setup, it&#8217;s best to not maintain a static list of cloud hostnames
in text files.  Rather, the best way to handle this is to use the ec2 dynamic inventory script.</p>
<p>This will also dynamically select nodes that were even created outside of Ansible, and allow Ansible to manage them.</p>
<p>See the doc:<cite>aws_example</cite> for how to use this, then flip back over to this chapter.</p>
</div>
<div class="section" id="tags-and-groups-and-variables">
<span id="aws-tags-and-groups"></span><h2>Tags And Groups And Variables<a class="headerlink" href="#tags-and-groups-and-variables" title="Permalink to this headline">¶</a></h2>
<p>When using the ec2 inventory script, hosts automatically appear in groups based on how they are tagged in EC2.</p>
<p>For instance, if a host is given the &#8220;class&#8221; tag with the value of &#8220;webserver&#8221;,
it will be automatically discoverable via a dynamic group like so:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>- hosts: tag_class_webserver
  tasks:
    - ping
</pre></div>
</div>
<p>Using this philosophy can be a great way to keep systems separated by the function they perform.</p>
<p>In this example, if we wanted to define variables that are automatically applied to each machine tagged with the &#8216;class&#8217; of &#8216;webserver&#8217;, &#8216;group_vars&#8217;
in ansible can be used.  See <code class="xref doc docutils literal"><span class="pre">splitting_out_vars</span></code>.</p>
<p>Similar groups are available for regions and other classifications, and can be similarly assigned variables using the same mechanism.</p>
</div>
<div class="section" id="autoscaling-with-ansible-pull">
<span id="aws-pull"></span><h2>Autoscaling with Ansible Pull<a class="headerlink" href="#autoscaling-with-ansible-pull" title="Permalink to this headline">¶</a></h2>
<p>Amazon Autoscaling features automatically increase or decrease capacity based on load.  There are also Ansible ansibles shown in the cloud documentation that
can configure autoscaling policy.</p>
<p>When nodes come online, it may not be sufficient to wait for the next cycle of an ansible command to come along and configure that node.</p>
<p>To do this, pre-bake machine images which contain the necessary ansible-pull invocation.  Ansible-pull is a command line tool that fetches a playbook from a git server and runs it locally.</p>
<p>One of the challenges of this approach is that there needs to be a centralized way to store data about the results of pull commands in an autoscaling context.
For this reason, the autoscaling solution provided below in the next section can be a better approach.</p>
<p>Read <a class="reference internal" href="playbooks_intro.html#ansible-pull"><span>Ansible-Pull</span></a> for more information on pull-mode playbooks.</p>
</div>
<div class="section" id="autoscaling-with-ansible-tower">
<span id="aws-autoscale"></span><h2>Autoscaling with Ansible Tower<a class="headerlink" href="#autoscaling-with-ansible-tower" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="tower.html"><em>Ansible Tower</em></a> also contains a very nice feature for auto-scaling use cases.  In this mode, a simple curl script can call
a defined URL and the server will &#8220;dial out&#8221; to the requester and configure an instance that is spinning up.  This can be a great way
to reconfigure ephemeral nodes.  See the Tower install and product documentation for more details.</p>
<p>A benefit of using the callback in Tower over pull mode is that job results are still centrally recorded and less information has to be shared
with remote hosts.</p>
</div>
<div class="section" id="ansible-with-and-versus-cloudformation">
<span id="aws-cloudformation-example"></span><h2>Ansible With (And Versus) CloudFormation<a class="headerlink" href="#ansible-with-and-versus-cloudformation" title="Permalink to this headline">¶</a></h2>
<p>CloudFormation is a Amazon technology for defining a cloud stack as a JSON document.</p>
<p>Ansible modules provide an easier to use interface than CloudFormation in many examples, without defining a complex JSON document.
This is recommended for most users.</p>
<p>However, for users that have decided to use CloudFormation, there is an Ansible module that can be used to apply a CloudFormation template
to Amazon.</p>
<p>When using Ansible with CloudFormation, typically Ansible will be used with a tool like Packer to build images, and CloudFormation will launch
those images, or ansible will be invoked through user data once the image comes online, or a combination of the two.</p>
<p>Please see the examples in the Ansible CloudFormation module for more details.</p>
</div>
<div class="section" id="aws-image-building-with-ansible">
<span id="aws-image-build"></span><h2>AWS Image Building With Ansible<a class="headerlink" href="#aws-image-building-with-ansible" title="Permalink to this headline">¶</a></h2>
<p>Many users may want to have images boot to a more complete configuration rather than configuring them entirely after instantiation.  To do this,
one of many programs can be used with Ansible playbooks to define and upload a base image, which will then get it&#8217;s own AMI ID for usage with
the ec2 module or other Ansible AWS modules such as ec2_asg or the cloudformation module.   Possible tools include Packer, aminator, and Ansible&#8217;s
ec2_ami module.</p>
<p>Generally speaking, we find most users using Packer.</p>
<p><a class="reference external" href="https://www.packer.io/docs/provisioners/ansible-local.html">Documentation for the Ansible Packer provisioner can be found here</a>.</p>
<p>If you do not want to adopt Packer at this time, configuring a base-image with Ansible after provisioning (as shown above) is acceptable.</p>
</div>
<div class="section" id="next-steps-explore-modules">
<span id="aws-next-steps"></span><h2>Next Steps: Explore Modules<a class="headerlink" href="#next-steps-explore-modules" title="Permalink to this headline">¶</a></h2>
<p>Ansible ships with lots of modules for configuring a wide array of EC2 services.  Browse the &#8220;Cloud&#8221; category of the module
documentation for a full list with examples.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="modules.html"><em>About Modules</em></a></dt>
<dd>All the documentation for Ansible modules</dd>
<dt><a class="reference internal" href="playbooks.html"><em>Playbooks</em></a></dt>
<dd>An introduction to playbooks</dd>
<dt><a class="reference internal" href="playbooks_delegation.html"><em>Delegation, Rolling Updates, and Local Actions</em></a></dt>
<dd>Delegation, useful for working with loud balancers, clouds, and locally executed steps.</dd>
<dt><a class="reference external" href="http://groups.google.com/group/ansible-devel">User Mailing List</a></dt>
<dd>Have a question?  Stop by the google group!</dd>
<dt><a class="reference external" href="http://irc.freenode.net">irc.freenode.net</a></dt>
<dd>#ansible IRC chat channel</dd>
</dl>
</div>
</div>
</div>


          </div>
          <div id="search-results"><gcse:searchresults-only></div>
          <footer>
  
    <div class="rst-footer-buttons">
      
        <a href="guide_rax.html" class="btn btn-neutral float-right" title="Rackspace Cloud Guide"/>Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="guides.html" class="btn btn-neutral" title="Detailed Guides"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <p>
  &copy; Copyright 2015 <a href="http://ansible.com">Ansible, Inc.</a>.
    Last updated on Feb 24, 2016.
  </p>

Ansible docs are generated from <a href="http://github.com/ansible/ansible">GitHub sources</A> using <A HREF="http://sphinx-doc.org/">Sphinx</A> using a theme provided by <a href="http://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  


<!-- begin analytics -->
<script type="text/javascript">
var _hsq = _hsq || [];
_hsq.push(["setContentType", "standard-page"]);
        (function(d,s,i,r) {
        if (d.getElementById(i)){return;}
        var n = d.createElement(s),e = document.getElementsByTagName(s)[0];
        n.id=i;n.src = '//js.hs-analytics.net/analytics/'+(Math.ceil(new Date()/r)*r)+'/330046.js';
        e.parentNode.insertBefore(n, e);
        })(document, "script", "hs-analytics",300000);
</script>
<!-- end analytics -->

</body>
</html>